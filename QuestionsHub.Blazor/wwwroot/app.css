/* Theme CSS Variables */
:root {
    --app-bg: #ffffff;
    --app-bg-secondary: #f7f7f7;
    --app-bg-tertiary: #fafafa;
    --app-text: #212529;
    --app-text-secondary: #333;
    --app-text-muted: #6c757d;
    --app-border: #d6d5d5;
    --app-border-light: #e0e0e0;
    --app-link: #006bb7;
    --app-primary: #1b6ec2;
    --app-primary-border: #1861ac;
    --app-card-bg: #fafafa;
    --app-input-bg: #ffffff;
    --app-handout-bg: #fff3cd;
    --app-handout-border: #ffc107;
    --app-host-bg: #e0e0e0;
    --app-host-border: #6c757d;
    --app-sortable-ghost: #c8ebfb;
    --app-sortable-chosen: #f8f9fa;
}

[data-bs-theme="dark"] {
    --app-bg: #212529;
    --app-bg-secondary: #2b3035;
    --app-bg-tertiary: #343a40;
    --app-text: #f8f9fa;
    --app-text-secondary: #dee2e6;
    --app-text-muted: #adb5bd;
    --app-border: #495057;
    --app-border-light: #495057;
    --app-link: #6ea8fe;
    --app-primary: #6ea8fe;
    --app-primary-border: #6ea8fe;
    --app-card-bg: #2b3035;
    --app-input-bg: #343a40;
    --app-handout-bg: #664d03;
    --app-handout-border: #997404;
    --app-host-bg: #495057;
    --app-host-border: #6c757d;
    --app-sortable-ghost: #1a4971;
    --app-sortable-chosen: #343a40;
}

/* Theme toggle icon visibility */
[data-bs-theme="dark"] .icon-sun {
    display: inline-block;
}
[data-bs-theme="dark"] .icon-moon {
    display: none;
}
[data-bs-theme="light"] .icon-sun,
:root:not([data-bs-theme]) .icon-sun {
    display: none;
}
[data-bs-theme="light"] .icon-moon,
:root:not([data-bs-theme]) .icon-moon {
    display: inline-block;
}

html {
    scroll-behavior: smooth;
}

html, body {
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
}

/* SVG Icon sprite helper */
.icon {
    display: inline-block;
    vertical-align: -0.125em;
    fill: currentColor;
}

a, .btn-link {
    color: var(--app-link);
}

.btn-primary {
    color: #fff;
    background-color: var(--app-primary);
    border-color: var(--app-primary-border);
}

.btn:focus, .btn:active:focus, .btn-link.nav-link:focus, .form-control:focus, .form-check-input:focus {
  box-shadow: 0 0 0 0.1rem white, 0 0 0 0.25rem #258cfb;
}

article.content {
    flex: 1 0 auto;
    padding-top: 1.1rem;
}

h1:focus {
    outline: none;
}

.valid.modified:not([type=checkbox]) {
    outline: 1px solid #26b050;
}

.invalid {
    outline: 1px solid #e50000;
}

.validation-message {
    color: #e50000;
}

.blazor-error-boundary {
    background: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTYiIGhlaWdodD0iNDkiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIG92ZXJmbG93PSJoaWRkZW4iPjxkZWZzPjxjbGlwUGF0aCBpZD0iY2xpcDAiPjxyZWN0IHg9IjIzNSIgeT0iNTEiIHdpZHRoPSI1NiIgaGVpZ2h0PSI0OSIvPjwvY2xpcFBhdGg+PC9kZWZzPjxnIGNsaXAtcGF0aD0idXJsKCNjbGlwMCkiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0yMzUgLTUxKSI+PHBhdGggZD0iTTI2My41MDYgNTFDMjY0LjcxNyA1MSAyNjUuODEzIDUxLjQ4MzcgMjY2LjYwNiA1Mi4yNjU4TDI2Ny4wNTIgNTIuNzk4NyAyNjcuNTM5IDUzLjYyODMgMjkwLjE4NSA5Mi4xODMxIDI5MC41NDUgOTIuNzk1IDI5MC42NTYgOTIuOTk2QzI5MC44NzcgOTMuNTEzIDI5MSA5NC4wODE1IDI5MSA5NC42NzgyIDI5MSA5Ny4wNjUxIDI4OS4wMzggOTkgMjg2LjYxNyA5OUwyNDAuMzgzIDk5QzIzNy45NjMgOTkgMjM2IDk3LjA2NTEgMjM2IDk0LjY3ODIgMjM2IDk0LjM3OTkgMjM2LjAzMSA5NC4wODg2IDIzNi4wODkgOTMuODA3MkwyMzYuMzM4IDkzLjAxNjIgMjM2Ljg1OCA5Mi4xMzE0IDI1OS40NzMgNTMuNjI5NCAyNTkuOTYxIDUyLjc5ODUgMjYwLjQwNyA1Mi4yNjU4QzI2MS4yIDUxLjQ4MzcgMjYyLjI5NiA1MSAyNjMuNTA2IDUxWk0yNjMuNTg2IDY2LjAxODNDMjYwLjczNyA2Ni4wMTgzIDI1OS4zMTMgNjcuMTI0NSAyNTkuMzEzIDY5LjMzNyAyNTkuMzEzIDY5LjYxMDIgMjU5LjMzMiA2OS44NjA4IDI1OS4zNzEgNzAuMDg4N0wyNjEuNzk1IDg0LjAxNjEgMjY1LjM4IDg0LjAxNjEgMjY3LjgyMSA2OS43NDc1QzI2Ny44NiA2OS43MzA5IDI2Ny44NzkgNjkuNTg3NyAyNjcuODc5IDY5LjMxNzkgMjY3Ljg3OSA2Ny4xMTgyIDI2Ni40NDggNjYuMDE4MyAyNjMuNTg2IDY2LjAxODNaTTI2My41NzYgODYuMDU0N0MyNjEuMDQ5IDg2LjA1NDcgMjU5Ljc4NiA4Ny4zMDA1IDI1OS43ODYgODkuNzkyMSAyNTkuNzg2IDkyLjI4MzcgMjYxLjA0OSA5My41Mjk1IDI2My41NzYgOTMuNTI5NSAyNjYuMTE2IDkzLjUyOTUgMjY3LjM4NyA5Mi4yODM3IDI2Ny4zODcgODkuNzkyMSAyNjcuMzg3IDg3LjMwMDUgMjY2LjExNiA4Ni4wNTQ3IDI2My41NzYgODYuMDU0N1oiIGZpbGw9IiNGRkU1MDAiIGZpbGwtcnVsZT0iZXZlbm9kZCIvPjwvZz48L3N2Zz4=) no-repeat 1rem/1.8rem, #b32121;
    padding: 1rem 1rem 1rem 3.7rem;
    color: white;
}

    .blazor-error-boundary::after {
        content: "An error has occurred."
    }

.darker-border-checkbox.form-check-input {
    border-color: #929292;
}

.form-floating > .form-control-plaintext::placeholder, .form-floating > .form-control::placeholder {
    color: var(--bs-secondary-color);
    text-align: end;
}

.form-floating > .form-control-plaintext:focus::placeholder, .form-floating > .form-control:focus::placeholder {
    text-align: start;
}

/* Auto-expandable textareas - grows with content */
.auto-expand {
    field-sizing: content;
    min-height: calc(1.5em + 0.75rem + 2px); /* Match Bootstrap form-control single line height */
    resize: none;
}

/* Sortable drag and drop styles */
.sortable-ghost {
    opacity: 0.4;
    background-color: var(--app-sortable-ghost);
}

.sortable-chosen {
    background-color: var(--app-sortable-chosen);
}

.sortable-drag {
    opacity: 1;
    background-color: var(--app-bg);
    box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
}

.tour-drag-handle,
.question-drag-handle,
.block-drag-handle {
    cursor: grab;
    color: var(--app-text-muted);
    user-select: none;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    touch-action: none;
    padding: 0.5rem;
    display: flex;
    align-items: center;
    justify-content: center;
}

.tour-drag-handle:hover,
.question-drag-handle:hover,
.block-drag-handle:hover {
    color: var(--app-text-secondary);
    background-color: rgba(128, 128, 128, 0.1);
}

.tour-drag-handle:active,
.question-drag-handle:active,
.block-drag-handle:active {
    cursor: grabbing;
}

/* Prevent text selection during drag on sortable items */
.accordion-item[data-tour-id],
.list-group-item[data-question-id],
.block-item[data-block-id] {
    user-select: none;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
}

/* Ensure accordion items are block level for sortable */
.accordion-item[data-tour-id] {
    display: block;
}

/* Accordion header with drag handle */
.accordion-header.d-flex .tour-drag-handle {
    font-size: 1.25rem;
    background-color: var(--app-sortable-chosen);
    border-right: 1px solid var(--app-border);
    min-width: 40px;
    align-self: stretch;
}

/* Blocks container for drag-and-drop between tours */
.blocks-container {
    min-height: 20px;
}

/* Answer visibility toggle for static SSR pages */
.answer-hidden {
    display: none !important;
}
/* Home page: expandable popular tags */
.tag-filter-btn.tag-hidden {
    display: none !important;
}

/* Clickable tag badges on package cards */
.package-tag[data-tag-id] {
    cursor: pointer;
    transition: opacity 0.15s;
}

.package-tag[data-tag-id]:hover {
    opacity: 0.8;
}

#tag-expand-btn:focus,
#tag-expand-btn:focus-visible {
    box-shadow: none;
    outline: none;
}

/* Home page filter panel */
.filter-panel {
    background-color: var(--app-bg-secondary);
    padding: 1rem;
    border-radius: 0.5rem;
    border: 1px solid var(--app-border-light);
}

/* Mobile: collapsible filter panel */
@media (max-width: 767.98px) {
    .filter-panel {
        display: none;
    }
    .filter-panel.show {
        display: block;
    }
}

/* Desktop: always visible */
@media (min-width: 768px) {
    .filter-panel {
        display: block !important;
    }
    #filter-toggle {
        display: none !important;
    }
}

/* Editor dropdown styling */
#editor-dropdown .dropdown-toggle::after {
    display: none;
}

#editor-dropdown .dropdown-toggle {
    background-color: var(--app-input-bg);
    border: 1px solid var(--app-border);
    cursor: pointer;
}

#editor-dropdown .dropdown-toggle:hover {
    border-color: var(--app-primary);
}

#editor-dropdown .editor-list {
    max-height: 300px;
    overflow-y: auto;
}

#editor-dropdown .dropdown-item {
    padding: 0.5rem 1rem;
    cursor: pointer;
}

#editor-dropdown .dropdown-item:hover {
    background-color: var(--app-bg-tertiary);
}

#editor-dropdown .dropdown-item.active {
    background-color: var(--app-primary);
    color: white;
}

/* Sort direction button — reset Bootstrap's input-group z-index so it doesn't overlap sticky top-row */
#sort-dir-btn {
    border-color: var(--app-border);
    z-index: auto !important;
}

#sort-dir-btn:hover {
    background-color: var(--app-bg-tertiary);
    color: inherit;
}

#sort-dir-btn .icon {
    fill: currentColor;
}

/* Pagination component — global styles so JS-rendered pagination also works */
.pagination-nav {
    display: flex;
    justify-content: center;
}

.pagination-nav .pagination-container {
    display: inline-flex;
    align-items: center;
    background-color: var(--bs-tertiary-bg, #f8f9fa);
    border-radius: 2rem;
    padding: 0.25rem 0.5rem;
    box-shadow: var(--bs-box-shadow-sm, 0 1px 3px rgba(0, 0, 0, 0.1));
    gap: 0.125rem;
}

.pagination-numbers {
    display: flex;
    align-items: center;
    gap: 0.125rem;
}

.pagination-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    min-width: 2.25rem;
    height: 2.25rem;
    padding: 0;
    border: none;
    border-radius: 50%;
    background: transparent;
    color: var(--bs-secondary-color, #6c757d);
    font-size: 1rem;
    cursor: pointer;
    transition: background-color 0.15s ease-in-out, color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
    text-decoration: none;
}

.pagination-btn:hover:not(.disabled):not(:disabled) {
    background-color: var(--bs-secondary-bg, #e9ecef);
    color: var(--bs-body-color, #212529);
    box-shadow: var(--bs-box-shadow-sm, 0 1px 2px rgba(0, 0, 0, 0.1));
}

.pagination-btn:focus-visible {
    outline: 2px solid var(--bs-primary, #0d6efd);
    outline-offset: 1px;
}

.pagination-btn.disabled,
.pagination-btn:disabled {
    color: var(--bs-tertiary-color, #ced4da);
    cursor: not-allowed;
    opacity: 0.65;
}

.pagination-btn.pagination-number {
    font-weight: 300;
    font-size: 0.875rem;
}

.pagination-btn.pagination-number.active {
    color: var(--bs-primary, #0d6efd);
    font-weight: 500;
    font-size: 1rem;
    cursor: default;
}

.pagination-btn i {
    font-size: 1rem;
}

/* ───────── 18+ Adult content blur ───────── */

.adult-blur-wrapper {
    position: relative;
    z-index: 0; /* contain stacking context so overlay can't escape */
    isolation: isolate;
}

.adult-blur-wrapper.blurred .question-text,
.adult-blur-wrapper.blurred .answer-section,
.adult-blur-wrapper.blurred .answer-toggle-section,
.adult-blur-wrapper.blurred .handout,
.adult-blur-wrapper.blurred .host-instructions,
.adult-blur-wrapper.blurred .media-container {
    filter: blur(8px);
    -webkit-filter: blur(8px);
    user-select: none;
    -webkit-user-select: none;
    pointer-events: none;
}

.adult-reveal-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgba(var(--bs-body-bg-rgb, 255, 255, 255), 0.15);
    cursor: pointer;
    z-index: 10;
    font-weight: 600;
    text-align: center;
    padding: 1rem;
    border-radius: 0.375rem;
}

.adult-reveal-overlay span {
    background: var(--bs-body-bg, #fff);
    padding: 0.5rem 1.25rem;
    border-radius: 0.5rem;
    border: 1px solid var(--bs-border-color, #dee2e6);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.12);
    font-size: 0.9rem;
}

.adult-blur-wrapper:not(.blurred) .adult-reveal-overlay {
    display: none;
}

.adult-package-banner {
    background: var(--bs-warning-bg-subtle, #fff3cd);
    border: 1px solid var(--bs-warning-border-subtle, #ffecb5);
    color: var(--bs-warning-text-emphasis, #664d03);
    padding: 1rem 1.5rem;
    border-radius: 0.5rem;
    margin-bottom: 1.5rem;
    text-align: center;
    font-size: 1rem;
}

.adult-package-banner button {
    margin-left: 1rem;
}